<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>yuzaR-Blog: Survival analysis 1: a gentle introduction into Kaplan-Meier Curves</title>

<meta property="description" itemprop="description" content="Survival time analysis is necessary in any study which investigates the time to a particular outcome of interest. Cancer studies in the medicine and the first failure of the car in the engineering field (failure time analysis) are good examples. The outcome of interest could be death, remission to relapse, progression, or failure. Point in time of reaching that outcome is generally called the event. Thank goodness, not every ‚Äúevent‚Äù is fatal üòÉ, but can sometimes even be a favorable outcome such as discharge from hospital. And thus, survival analysis is also a generic term, because it is not only about survival."/>

<link rel="canonical" href="https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-01-03"/>
<meta property="article:created" itemprop="dateCreated" content="2021-01-03"/>
<meta name="article:author" content="Yury Zablotski"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="yuzaR-Blog: Survival analysis 1: a gentle introduction into Kaplan-Meier Curves"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Survival time analysis is necessary in any study which investigates the time to a particular outcome of interest. Cancer studies in the medicine and the first failure of the car in the engineering field (failure time analysis) are good examples. The outcome of interest could be death, remission to relapse, progression, or failure. Point in time of reaching that outcome is generally called the event. Thank goodness, not every ‚Äúevent‚Äù is fatal üòÉ, but can sometimes even be a favorable outcome such as discharge from hospital. And thus, survival analysis is also a generic term, because it is not only about survival."/>
<meta property="og:url" content="https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/"/>
<meta property="og:image" content="https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/thumbnail_survival_1.png"/>
<meta property="og:image:width" content="1920"/>
<meta property="og:image:height" content="1080"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="yuzaR-Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="yuzaR-Blog: Survival analysis 1: a gentle introduction into Kaplan-Meier Curves"/>
<meta property="twitter:description" content="Survival time analysis is necessary in any study which investigates the time to a particular outcome of interest. Cancer studies in the medicine and the first failure of the car in the engineering field (failure time analysis) are good examples. The outcome of interest could be death, remission to relapse, progression, or failure. Point in time of reaching that outcome is generally called the event. Thank goodness, not every ‚Äúevent‚Äù is fatal üòÉ, but can sometimes even be a favorable outcome such as discharge from hospital. And thus, survival analysis is also a generic term, because it is not only about survival."/>
<meta property="twitter:url" content="https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/"/>
<meta property="twitter:image" content="https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/thumbnail_survival_1.png"/>
<meta property="twitter:image:width" content="1920"/>
<meta property="twitter:image:height" content="1080"/>
<meta property="twitter:site" content="@yuzaR___"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="yuzaR-Blog: Survival analysis 1: a gentle introduction into Kaplan-Meier Curves"/>
<meta name="citation_fulltext_html_url" content="https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2021/01/03"/>
<meta name="citation_publication_date" content="2021/01/03"/>
<meta name="citation_author" content="Yury Zablotski"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","categories","preview","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Survival analysis 1: a gentle introduction into Kaplan-Meier Curves"]},{"type":"character","attributes":{},"value":["Survival time analysis is necessary in any study which investigates the time to a particular outcome of interest. Cancer studies in the medicine and the first failure of the car in the engineering field (failure time analysis) are good examples. The outcome of interest could be death, remission to relapse, progression, or failure. Point in time of reaching that outcome is generally called the event. Thank goodness, not every ‚Äúevent‚Äù is fatal üòÉ, but can sometimes even be a favorable outcome such as discharge from hospital. And thus, survival analysis is also a generic term, because it is not only about survival."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Yury Zablotski"]},{"type":"character","attributes":{},"value":["https://yury-zablotski.netlify.app/"]}]}]},{"type":"character","attributes":{},"value":["01-03-2021"]},{"type":"character","attributes":{},"value":["survival analysis","videos"]},{"type":"character","attributes":{},"value":["thumbnail_survival_1.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_float","code_download"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/"]},{"type":"character","attributes":{},"value":["https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["death.jpeg","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/anchor-4.2.2/anchor.min.js","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/bowser-1.9.3/bowser.min.js","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/distill-2.2.21/template.v2.js","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-17-1.png","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-19-1.png","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-20-1.png","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-23-1.png","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-25-1.png","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-4-1.png","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-5-1.png","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-6-1.png","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/header-attrs-2.8.6/header-attrs.js","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/jquery-1.11.3/jquery.min.js","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/popper-2.6.0/popper.min.js","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/tippy-6.2.7/tippy-bundle.umd.min.js","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/tippy-6.2.7/tippy-light-border.css","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/tippy-6.2.7/tippy.css","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/tippy-6.2.7/tippy.umd.min.js","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/vembedr-0.1.4/css/vembedr.css","survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/webcomponents-2.0.0/webcomponents.js","Survivorship-bias.png","thumbnail_survival_1.png","titanic.jpg"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */





html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       25px;
  --text-color:       white;
  --text-size:        25px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
  font-weight: bold;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.8.6/header-attrs.js"></script>
  <link href="../../site_libs/vembedr-0.1.4/css/vembedr.css" rel="stylesheet" />
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=G-Q28WX9Y4VS"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-Q28WX9Y4VS');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Survival analysis 1: a gentle introduction into Kaplan-Meier Curves","description":"Survival time analysis is necessary in any study which investigates the time to a particular outcome of interest. Cancer studies in the medicine and the first failure of the car in the engineering field (failure time analysis) are good examples. The outcome of interest could be death, remission to relapse, progression, or failure. Point in time of reaching that outcome is generally called the event. Thank goodness, not every ‚Äúevent‚Äù is fatal üòÉ, but can sometimes even be a favorable outcome such as discharge from hospital. And thus, survival analysis is also a generic term, because it is not only about survival.","authors":[{"author":"Yury Zablotski","authorURL":"https://yury-zablotski.netlify.app/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-01-03T00:00:00.000+01:00","citationText":"Zablotski, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="../../images/my_foto.jpg" alt="Logo"/>
</a>
<a href="../../index.html" class="title">yuzaR-Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../about.html">ABOUT</a>
<a href="../../index.html">POSTS</a>
<a href="../../consulting.html">CONSULTING</a>
<a href="https://www.youtube.com/channel/UCcGXGFClRdnrwXsPHi7P4ZA">
<i class="fa fa-youtube-square" aria-hidden="true"></i>
</a>
<a href="https://twitter.com/yuzaR___">
<i class="fa fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/dr-yury-zablotski-3765b378/">
<i class="fa fa-linkedin" aria-hidden="true"></i>
</a>
<a href="https://github.com/yuryzablotski/yuzaR-Blog">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="https://koji.to/yuzaR">LEAVE A TIP</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Survival analysis 1: a gentle introduction into Kaplan-Meier Curves</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:survival_analysis" class="dt-tag">survival analysis</a>
  <a href="../../index.html#category:videos" class="dt-tag">videos</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Survival time analysis is necessary in any study which investigates the time to a particular outcome of interest. Cancer studies in the medicine and the first failure of the car in the engineering field (failure time analysis) are good examples. The outcome of interest could be death, remission to relapse, progression, or failure. Point in time of reaching that outcome is generally called the event. Thank goodness, not every ‚Äúevent‚Äù is fatal üòÉ, but can sometimes even be a favorable outcome such as discharge from hospital. And thus, survival analysis is also a generic term, because it is not only about survival.</p></p>
</div>

<div class="d-byline">
  Yury Zablotski <a href="https://yury-zablotski.netlify.app/" class="uri">https://yury-zablotski.netlify.app/</a> 
  
<br/>01-03-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#previous-topics">Previous topics</a></li>
<li><a href="#why-do-we-need-survival-analysis">Why do we need survival analysis?</a>
<ul>
<li><a href="#death-is-not-the-only-option-or-what-is-an-event">Death is not the only option! Or: ‚ÄúWhat is an event?‚Äù</a></li>
<li><a href="#censoring">Censoring</a></li>
</ul></li>
<li><a href="#how-to-calculate-kaplan-meier-survival-curve-manually-step-by-step">How to calculate Kaplan-Meier survival curve ‚Äúmanually‚Äù step by step</a>
<ul>
<li><a href="#survival-probability">Survival probability</a></li>
</ul></li>
<li><a href="#how-to-compute-kaplan-meier-survival-curve">How to compute Kaplan-Meier survival curve</a>
<ul>
<li><a href="#interpretation-of-kaplan-meier-curve">Interpretation of Kaplan-Meier Curve</a></li>
</ul></li>
<li><a href="#comparing-survival-of-groups">Comparing survival of groups</a>
<ul>
<li><a href="#groups">2 groups</a></li>
<li><a href="#interpretation-of-groups-comparison-using-4-benchmarks">Interpretation of groups comparison using 4 benchmarks</a></li>
<li><a href="#log-rank-test">Log-Rank test</a></li>
<li><a href="#groups-and-multiple-pairwise-post-hoc-log-rank-test">&gt; 2 groups and multiple pairwise (post-hoc) Log-Rank test</a></li>
<li><a href="#multiple-survival-curves">Multiple survival curves</a></li>
</ul></li>
<li><a href="#conclusions">Conclusions</a></li>
<li><a href="#whats-next">What‚Äôs next?</a></li>
<li><a href="#further-readings-videos-and-references">Further readings, videos and references</a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>  <span class='co'># data wrangling and visualization</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjPlot/'>sjPlot</a></span><span class='op'>)</span>     <span class='co'># for plotting results of log.regr.</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.r-project.org'>effects</a></span><span class='op'>)</span>    <span class='co'># for probability output and plots</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/therneau/survival'>survival</a></span><span class='op'>)</span>   <span class='co'># for core survival analysis routines</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rpkgs.datanovia.com/survminer/index.html'>survminer</a></span><span class='op'>)</span>  <span class='co'># for drawing survival curves</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yihui.org/knitr/'>knitr</a></span><span class='op'>)</span>      <span class='co'># for a wonderful-looking tables</span>
</code></pre>
</div>
</div>
<p>If you are more of a visual person, you can watch the video below first, but for more details and R-code have a look at the article.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/TWyQVtchcpc" width="533" height="300" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>
</div>
<p>Can there be something more horrifying, then a Titanic crash with lots of immediate deaths? Well, unfortunately, yes! Namely, not immediate deaths. Imagine survived people in the middle of the cold dark ocean, some in life jackets, some without, clinging on ship remains, with a huge panic and little hope for rescue. There will be no helicopter to save them (it‚Äôs 1912). There might not be a single ship in those waters for months. <strong>How long will they survive?</strong> Will <strong>time</strong> simply prolong their suffering or increase the probability of survival, because eventually they will be found by some random ship? Do women have higher chances of survival then men? What about rich vs.¬†pure passengers? Well, in this post we‚Äôll find answers to all of these questions and along the way learn how survival analysis works. Particularly, we will:</p>
<ul>
<li><strong>learn</strong> about the most <strong>important concepts</strong> of survival analysis: survival curve, censoring and log-rank test,</li>
<li>manually <strong>calculate</strong>, then <strong>compute</strong> and <strong>interpret</strong> survival curves, and</li>
<li><strong>test survival differences</strong> between two or more groups, e.g.¬†females vs.¬†males</li>
</ul>
<p><img src="titanic.jpg" /></p>
<p><a href="https://wallpapersafari.com/titanic-wallpapers-free-download/">Source</a></p>
<h2 id="previous-topics">Previous topics</h2>
<p>A good understanding of <a href="https://yury-zablotski.netlify.com/post/simple-linear-regression/">linear</a> and <a href="https://yury-zablotski.netlify.com/post/how-logistic-regression-works/">logistic</a> regressions would improve the digestion of this post.</p>
<h2 id="why-do-we-need-survival-analysis">Why do we need survival analysis?</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>

<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>
  time   <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>7</span>,<span class='fl'>10</span><span class='op'>)</span>, 
  status <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>d</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">time</th>
<th style="text-align: right;">status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p>To answer this question, let‚Äôs start with a small example of Titanic survivors: only 10 people and only 10 days on the sea after the crash and analyse it with the classic statistical methods, linear and logistic regressions. We are interested in how many people and how long survived and how many died on a particular day. Thus, <strong>two main parameters of interest</strong> for us are (1) <strong>time</strong> (in days) and (2) ‚Äú<strong>life-status</strong>‚Äù of people, where ‚Äústatus = 1‚Äù means death and ‚Äústatus = 0‚Äù means not-death. And having the status of people we could just have counted survivors and not-survivors at each particular day to understand what was going on, wright?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>d</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>time</span>, fill <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>status</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span>position <span class='op'>=</span> <span class='fu'>position_dodge</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<p>Well, not quite. Besides, the fact that the plot with our counts is not particularly revealing, we have <strong>two problems</strong> with that:</p>
<ol type="1">
<li><p>The first one is that ‚Äústatus = 0‚Äù does not always mean a survival. First, the person might be carried away by the waves and disappear. We lost the person and we don‚Äôt know it‚Äôs status. It might have died, it might have been saved by a fisher boat or is still alive somewhere in the ocean. We are not sure. The only thing what we are sure about is that this person <strong>can not be counted as dead or survived</strong>. Secondly, if some people survived 10 days, they might die at day 11. So, the time plays a role here and brings us to the second problem.</p></li>
<li><p>We do not have the data for every of these 10 days. Only for 7. Moreover, if I did not eat anything for 5 days, my survival probability at day 5, where I certainly survived, is not 100%. It is lower, because hunger <strong>accumulates over time</strong>. Similarly, a decrease of my survival probability also <strong>accumulates over time</strong>, which can not be determined by a simple counting of survivors vs.¬†not-survivors at a particular day.</p></li>
</ol>
<p>Despite this problems we still can analyse these data. We only <strong>need to find the right method</strong> for it.</p>
<ol type="1">
<li>Looking at the numeric variable ‚Äútime‚Äù, we might be tempted to use a linear regression to model the survival time for two different status groups, 0 &amp; 1:</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>time</span> <span class='op'>~</span> <span class='va'>status</span>, <span class='va'>d</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>status <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>status</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.r-project.org'>effects</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/effects/man/effect.html'>allEffects</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p>But when we plot the model results, we realize that something isn‚Äôt quite right there. All the information we have to model the survival time are zeros and ones. And the average time of dying (status = 1) of 2.5 days misses lot‚Äôs of information. For instance, half of the people (3 persons) died on the very first day! And the further we go in time, the less additional people die, which we can see on the very first counts-plot above. So, the survival time is not really linear and can certainly not be described with only zeros and ones! Thus, a linear model does not seem to be useful here. Then what is?</p>
<ol start="2" type="1">
<li>Since we have zeros and ones in the status column we can use a logistic regression, right?! Yes! Especially because probability curve is not linear and will catch the trend of survival over time. Cool! Let‚Äôs go with it:</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>status</span> <span class='op'>~</span> <span class='va'>time</span>, <span class='va'>d</span>, family <span class='op'>=</span> <span class='va'>binomial</span><span class='op'>)</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjPlot/'>sjPlot</a></span><span class='op'>)</span>
<span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/plot_model.html'>plot_model</a></span><span class='op'>(</span><span class='va'>m</span>, type <span class='op'>=</span> <span class='st'>"pred"</span>, ci.lvl <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>$time</code></pre>
<p><img src="survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<p>Now we have the non-linear survival probabilities :), which is a great improvement as compared to a linear regression. However, the fifth observation has a status of 0 at day 2. This means that the person survived for 2 days for sure, but was lost after it. ‚ÄúSo what?‚Äù, - you might ask. The probabilities in logistic regression would count this person as a 100% survivor after the second day simply because it‚Äôs status is not ‚Äú=1‚Äù, which is wrong (or biased), since we don‚Äôt know whether this person survived. Thus, logistic regression overestimates survival probability and is therefore also an inappropriate tool to analyze survival data.</p>
<p>So, it looks like we can‚Äôt analyse <strong>survival data</strong> with classic methods. And that is exactly why we need survival analysis method.</p>
<p>While linear regression models describe the time, but miss a non-linear survival probability, logistic regression catches a non-linear trend, but overestimates survival probability. In contrast, <strong>survival analysis</strong> solves both issues, since it models non-linear survival probabilities over time while accounting for lost subjects of the study which are either dead nor survived.</p>
<h3 id="death-is-not-the-only-option-or-what-is-an-event">Death is not the only option! Or: ‚ÄúWhat is an event?‚Äù</h3>
<p><img src="death.jpeg" /></p>
<p>Image by Luke Southern on unsplash.</p>
<p><strong>Survival time analysis</strong> is necessary in any study which investigates <strong>the time to a particular outcome of interest</strong>. Cancer studies in the medicine and the first failure of the car in the engineering field (<strong>failure time analysis</strong>) are good examples. The <strong>outcome of interest</strong> could be death, remission to relapse, progression, or failure. Point in time of reaching that outcome is generally called the <strong>event</strong>. Thank goodness, not every ‚Äúevent‚Äù is fatal üòÉ, but can sometimes even be a favorable outcome such as discharge from hospital. And thus, survival analysis is also a generic term, because it is not only about survival.</p>
<p><strong>The event, as a final fixed point in time is needed</strong> because we can‚Äôt observe or experiment forever. If we study lung cancer, we can‚Äôt wait until patients die from other causes, e.g.¬†being old. Only when some of patients survive cancer, or some cars don‚Äôt break by a <strong>certain time (event)</strong>, we can get valuable insights. For instance, what is the time from the start of the treatment to progression, or what is the probability to survive lung cancer after exactly 1 year? Moreover, it opens the possibility to compare survival or failure times among different groups, e.g.¬†lung cancer between smokers and non-smokers, or breakdown time between German and Korean cars.</p>
<p>So, the <strong>survival time</strong> has a start and a finish point - <strong>the event</strong>. But what if a patient withdraw from the study due to a personal reasons, or a car got stolen 1 day before the event? Will they ‚Äúsurvive‚Äù by the time of the event? We don‚Äôt know! But they certainly survived from the start of the study until the point we lost them. And this is a valuable information we surely want to include in our analysis! But how do we differentiate ‚Äúlost‚Äù survivors from the ‚Äúreal‚Äù survivors? Well, we just call them a new name - <strong>censored</strong>. Str–∞nge word to apply to a person, right? But as I thought about the <strong>inappropriate</strong> information in a book or swearing on TV, which is often <strong>getting censored</strong>, the concept of censoring a patient became more digestible to me. See, since we can not say that person has died or is still alive, simply because we <strong>DO NOT HAVE ENOUGH INFORMATION</strong>, both of conclusions would be <strong>inappropriate</strong>, and thus, we <strong>censor</strong> this person. The concept of <strong>censoring</strong> is so important, that it deserves an extra chapter.</p>
<h3 id="censoring">Censoring</h3>
<div class="alert alert-success" role="alert">
<p>The need for censoring arises from the fact that the actual survival times will be unknown for some individuals. There are lots of ways to loose a subject of study:</p>
<ul>
<li>we can loose an individual for no reason, when it simply does not appear anymore</li>
<li>the individual may experience another event, e.g.¬†death or accident</li>
<li>even patients who survived till the very end of the study can be treated as censored due the unknown survival time (I personally prefer to see these patients as <strong>survived</strong>)</li>
</ul>
<p>All examples above are considered to be <strong>right censoring</strong> due to their direction from left to right on the time-axes. Most of survival data are right censored. There are two other kinds of censoring. <strong>Left censoring</strong> appears if we do not know where the sickness began, while <strong>interval censoring</strong> happens when the exact time of patient loss is not known, but only a time window. Both left and interval censorings are rare, difficult to analyse, are often a result of a bad study design, and thus, will not be covered here.</p>
<p>Important to remember is that <strong>censored observations still provide useful information! That is why they need to be included into analysis</strong>.</p>
</div>
<h2 id="how-to-calculate-kaplan-meier-survival-curve-manually-step-by-step">How to calculate Kaplan-Meier survival curve ‚Äúmanually‚Äù step by step</h2>
<p>Imagine a peaceful sunny <strong>day right before the Titanic crash</strong>. No one has died, but all 10 people are at high risk (hazard) of death, they just don‚Äôt know it yet. Guess, how many people would probably die the day before the crash? The answer is - <strong>probably</strong> zero. Literally, the probability of dying is zero, because we know the crash will not happen the day before the actual crush. To answer this question more properly, we need to remember the definition of probability: <strong>Probabilities are ratios of something happening, to everything what can happen.</strong> Thus, if nobody out of all 10 people died the day before the crash, the probability of dying is 0%, while the probability of surviving is 100%:</p>
<p><span class="math display">\[ probability \ of \ dying = \frac{0}{10} = 0\]</span></p>
<p><span class="math display">\[ probability \ of \ surviving = \frac{10}{10} = 1  = 100\%\]</span></p>
<p>For a better representation, let‚Äôs put all the numbers in one single table:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tribble</span><span class='op'>(</span>
  <span class='op'>~</span><span class='va'>time_in_days</span>, <span class='op'>~</span><span class='va'>N_at_risk</span>, <span class='op'>~</span><span class='va'>N_died</span>, <span class='op'>~</span><span class='va'>P_dying</span>, <span class='op'>~</span><span class='va'>`P_surviving`</span>,
  <span class='fl'>0</span>, <span class='fl'>10</span>, <span class='fl'>0</span>, <span class='st'>"0/10 = 0"</span>, <span class='st'>"10/10 = 1"</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">time_in_days</th>
<th style="text-align: right;">N_at_risk</th>
<th style="text-align: right;">N_died</th>
<th style="text-align: left;">P_dying</th>
<th style="text-align: left;">P_surviving</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0/10 = 0</td>
<td style="text-align: left;">10/10 = 1</td>
</tr>
</tbody>
</table>
</div>
<p>Then, at the <strong>day of the crash</strong>, where all 10 people are now know that they are at high risk of dying, 3 of them have actually died. The probability of dying at the first day is then <span class="math inline">\(3/10 = 0.3 \approx 30\%\)</span> and the probability of surviving is <span class="math inline">\(7/10 = 0.7 \approx 70\%\)</span>. As you can see, the survival can be also calculated from the probability of dying <span class="math inline">\(1-0.3 = 0.7\)</span>, which is sometimes very useful.</p>
<h3 id="survival-probability">Survival probability</h3>
<div class="alert alert-success" role="alert">
<p>One important moment here is that <strong>the probability of surviving is cumulative</strong>, which means it <strong>accumulates</strong> day by day. This accumulation happens via <strong>multiplying</strong> the <strong>new probability</strong> of surviving day 1 <span class="math inline">\((1 - \frac{d_i}{n_i}) = (1 - \frac{3}{10}) = 70\%\)</span> by the <strong>old probability</strong> of surviving all the time before, which in our case is the day before the accident, or - day zero <span class="math inline">\(S(t_{i-1}) = 100\%\)</span>:</p>
<p><span class="math display">\[ S(t_i) = S(t_{i-1})*(1 - \frac{d_i}{n_i}) = 1 * (1 - \frac{3}{10}) = 0.7 \]</span></p>
<p>Where,</p>
<ul>
<li><span class="math inline">\(S(t_{i‚àí1})\)</span> = the probability of being alive at <span class="math inline">\(t_{i‚àí1}\)</span></li>
<li><span class="math inline">\(n_i\)</span> = the number of patients alive just before <span class="math inline">\(t_i\)</span></li>
<li><span class="math inline">\(d_i\)</span> = the number of events at <span class="math inline">\(t_i\)</span></li>
<li><span class="math inline">\(t_0\)</span> = 0, <span class="math inline">\(S(0)\)</span> = 1</li>
</ul>
<p>The survival probability at a certain time, <span class="math inline">\(S(t)\)</span>, is <strong>conditional</strong> because the person <strong>needs to have survived beyond that certain time</strong>, e.g.¬†the zero day (that‚Äôs the condition) in order to remain in the experiment for the first day.</p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tribble</span><span class='op'>(</span>
  <span class='op'>~</span><span class='va'>time_in_days</span>, <span class='op'>~</span><span class='va'>N_at_risk</span>, <span class='op'>~</span><span class='va'>N_died</span>, <span class='op'>~</span><span class='va'>P_dying</span>, <span class='op'>~</span><span class='va'>`P_surviving`</span>,
  <span class='fl'>0</span>, <span class='fl'>10</span>, <span class='fl'>0</span>, <span class='st'>"0/10 = 0"</span>,   <span class='st'>"10/10      = 1"</span>,
  <span class='fl'>1</span>, <span class='fl'>10</span>, <span class='fl'>3</span>, <span class='st'>"3/10 = 0.3"</span>, <span class='st'>"1 * (7/10) = 0.7"</span>,
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">time_in_days</th>
<th style="text-align: right;">N_at_risk</th>
<th style="text-align: right;">N_died</th>
<th style="text-align: left;">P_dying</th>
<th style="text-align: left;">P_surviving</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0/10 = 0</td>
<td style="text-align: left;">10/10 = 1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">3/10 = 0.3</td>
<td style="text-align: left;">1 * (7/10) = 0.7</td>
</tr>
</tbody>
</table>
</div>
<p>The <strong>second day</strong> is a little more interesting, because one person died and one simply disappeared (status = 0). This lost person was most likely carried away by the waves and hopefully was rescued. The hope is big, because the further people are scattered in the ocean, the higher the chances are that one of them will be found alive. And this one will let the world know that others are still out there. So, despite the fact that missing person seems bad, it might turn out to be a good thing. So, we certainly can not count a missed person as - dead. Besides, as a German proverb says: ‚ÄúHope is the last to die‚Äù üòâ.</p>
<p>But since we are also not sure whether this person is still alive, we can‚Äôt say - the person survived. That produces a dilemma: despite not being dead, the person is not part of our experiment anymore and we have to remove it from the number of people at risk. So, while the <strong>second day</strong> would have 7 people at risk left (since 3 have died at the very first day), the <strong>third day</strong> would be left with only 5 people, because 1 person died and one disappeared (was censored) as compared to day two. Similarly to the first day, the survival probability is cumulative and always includes the probability of the day before.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tribble</span><span class='op'>(</span>
  <span class='op'>~</span><span class='va'>time_in_days</span>, <span class='op'>~</span><span class='va'>N_at_risk</span>, <span class='op'>~</span><span class='va'>N_died</span>, <span class='op'>~</span><span class='va'>P_dying</span>, <span class='op'>~</span><span class='va'>`P_surviving`</span>,
  <span class='fl'>0</span>, <span class='fl'>10</span>, <span class='fl'>0</span>, <span class='st'>"0/10 = 0"</span>,    <span class='st'>"10/10       = 1"</span>,
  <span class='fl'>1</span>, <span class='fl'>10</span>, <span class='fl'>3</span>, <span class='st'>"3/10 = 0.3"</span>,  <span class='st'>"1 * (7/10)  = 0.7"</span>,
  <span class='fl'>2</span>, <span class='fl'>7</span>,  <span class='fl'>1</span>, <span class='st'>"1/7  = 0.14"</span>, <span class='st'>"0.7 * (6/7) = 0.6"</span>,
  <span class='fl'>3</span>, <span class='fl'>5</span>,  <span class='fl'>1</span>, <span class='st'>"1/5  = 0.20"</span>, <span class='st'>"0.6 * (4/5) = 0.48"</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">time_in_days</th>
<th style="text-align: right;">N_at_risk</th>
<th style="text-align: right;">N_died</th>
<th style="text-align: left;">P_dying</th>
<th style="text-align: left;">P_surviving</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0/10 = 0</td>
<td style="text-align: left;">10/10 = 1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">3/10 = 0.3</td>
<td style="text-align: left;">1 * (7/10) = 0.7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">1/7 = 0.14</td>
<td style="text-align: left;">0.7 * (6/7) = 0.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">1/5 = 0.20</td>
<td style="text-align: left;">0.6 * (4/5) = 0.48</td>
</tr>
</tbody>
</table>
</div>
<p>The <strong>next two days</strong> two people disappeared, so, we censor them. There is no need to calculate something for censored data in survival analysis, because we don‚Äôt know whether they survived or not. And since we are interested in either survival or death, the final table below contains <strong>only dead</strong> cases. At <strong>day 6</strong> nobody died or disappeared, that is why we do not calculate anything for that day either. The last person in our experiment died at <strong>day 7</strong>. So, ‚ÄúN_died‚Äù will be 1, and ‚ÄúN_at_risk‚Äù will be 2, since 1 out of remaining 5 has died and 2 were censored. Thus, the full ‚Äúmanually‚Äù calculated table will look like this:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tribble</span><span class='op'>(</span>
  <span class='op'>~</span><span class='va'>time_in_days</span>, <span class='op'>~</span><span class='va'>N_at_risk</span>, <span class='op'>~</span><span class='va'>N_died</span>, <span class='op'>~</span><span class='va'>P_dying</span>, <span class='op'>~</span><span class='va'>`P_surviving`</span>,
  <span class='fl'>0</span>, <span class='fl'>10</span>, <span class='fl'>0</span>, <span class='st'>"0/10 = 0"</span>,    <span class='st'>"10/10        = 1"</span>,
  <span class='fl'>1</span>, <span class='fl'>10</span>, <span class='fl'>3</span>, <span class='st'>"3/10 = 0.3"</span>,  <span class='st'>"1 * (7/10)   = 0.7"</span>,
  <span class='fl'>2</span>, <span class='fl'>7</span>,  <span class='fl'>1</span>, <span class='st'>"1/7  = 0.14"</span>, <span class='st'>"0.7 * (6/7)  = 0.6"</span>,
  <span class='fl'>3</span>, <span class='fl'>5</span>,  <span class='fl'>1</span>, <span class='st'>"1/5  = 0.20"</span>, <span class='st'>"0.6 * (4/5)  = 0.48"</span>,
  <span class='fl'>7</span>, <span class='fl'>2</span>,  <span class='fl'>1</span>, <span class='st'>"1/2  = 0.50"</span>, <span class='st'>"0.48 * (1/2) = 0.24"</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">time_in_days</th>
<th style="text-align: right;">N_at_risk</th>
<th style="text-align: right;">N_died</th>
<th style="text-align: left;">P_dying</th>
<th style="text-align: left;">P_surviving</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0/10 = 0</td>
<td style="text-align: left;">10/10 = 1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">3/10 = 0.3</td>
<td style="text-align: left;">1 * (7/10) = 0.7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">1/7 = 0.14</td>
<td style="text-align: left;">0.7 * (6/7) = 0.6</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">1/5 = 0.20</td>
<td style="text-align: left;">0.6 * (4/5) = 0.48</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">1/2 = 0.50</td>
<td style="text-align: left;">0.48 * (1/2) = 0.24</td>
</tr>
</tbody>
</table>
</div>
<p>But what happens <strong>if we ignore censoring</strong> and simply calculate the probability of being not dead? Well, since 4 people did not die on day 7, the probability of survival would be <span class="math inline">\(\frac{4}{10} = 40\%\)</span> which is almost twice as high, and thus <strong>we‚Äôll massively overestimate survival probability</strong>, as compared to the actual probability of 0.24 which accounts for censoring!</p>
<div class="alert alert-info" role="alert">
<p><strong>Story time:</strong></p>
<p><img src="Survivorship-bias.png" /></p>
<p><a href="https://de.wikipedia.org/wiki/Survivorship_Bias">Source</a></p>
<p><strong>Only paying attention to survivors</strong> even has a name - <strong>survivorship bias</strong>, and there is a small story to it. During the Second World War some planes came back from the battle field with a lot of damage from bullets. They barely could fly, but they still came back. So, the military decided to protect the aircraft with more armor at the places where the most bullet-holes were, like wings, and reduce the armor at the places with no bullet-holes. Surprisingly, the percentage of planes which came back did not increase. The engineers were puzzled! Until one mathematician, Abraham Walt, which were invited to solve this problem said: ‚ÄúPut more armor on places with no bullet-holes, because if these place are shot, the plane won‚Äôt come back.‚Äù And as the others thought about it, they realized that all the planes which came back did not have any bullet-holes on the cockpit or the engines. The bullet-holes shows all the places where the aircraft can be shot but still come back, or survive! That is the <strong>survivorship bias</strong>. So, it seems to me, that logistic regression has a <strong>survivorship bias</strong> as compared to the survival analysis if we wanna analyse survival data.</p>
</div>
<h2 id="how-to-compute-kaplan-meier-survival-curve">How to compute Kaplan-Meier survival curve</h2>
<p>Load all needed packages at once to avoid interruptions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>  <span class='co'># data wrangling and visualization</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yihui.org/knitr/'>knitr</a></span><span class='op'>)</span>      <span class='co'># beautifying tables</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-forge.r-project.org/projects/car/'>car</a></span><span class='op'>)</span>        <span class='co'># for checking assumptions, e.g. vif etc.</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://broom.tidymodels.org/'>broom</a></span><span class='op'>)</span>      <span class='co'># for tidy model output</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjPlot/'>sjPlot</a></span><span class='op'>)</span>     <span class='co'># for plotting results of log.regr.</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjmisc/'>sjmisc</a></span><span class='op'>)</span>     <span class='co'># for plotting results of log.regr.</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.r-project.org'>effects</a></span><span class='op'>)</span>    <span class='co'># for probability output and plots</span>
</code></pre>
</div>
</div>
<p>First of all, please, be sure you know exactly what 0s and 1s in your data mean! Because in a <em>logistic regression</em> 1 is the survival, while in a <em>survival analysis</em> 1 is death! Secondly, we have to differentiate censored cases somehow, e.g.¬†we can mark them with a <strong>plus sign</strong> in the data or on the plot. The data below shows that people were censored on days 2+, 4+, 5+ and 10+. Install and load a <code>survival</code> package to be able to execute the code below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># install.packages("survival")</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/therneau/survival'>survival</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span>time <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>time</span>, event <span class='op'>=</span> <span class='va'>d</span><span class='op'>$</span><span class='va'>status</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> [1]  1   1   1   2   2+  3   4+  5+  7  10+</code></pre>
</div>
<p>The <code>Surv</code> function unites ‚Äútime‚Äù and ‚Äústatus‚Äù data into a single <strong>‚Äúsurvival‚Äù object</strong>, which allows to <strong>account for censored observations</strong>. This object can then be used to model survival probability by the <code>survfit</code> function. We model the survival by adding ‚Äú~ 1‚Äù to the object, where 1 means <em>no variables</em> which could have influenced the survival. Our survival object on the left side of the <em>tilde</em> is then the response variable and on the right site of the ~ (<em>tilde</em>) are predictors, or in our case of ‚Äú1‚Äù - nothing. Let‚Äôs produce our fist survival model and have a look at the model output:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>survival_model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/survfit.html'>survfit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>status</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span>

<span class='co'># small summary</span>
<span class='va'>survival_model</span>
</code></pre>
</div>
<pre><code>Call: survfit(formula = Surv(time, status) ~ 1, data = d)

      n  events  median 0.95LCL 0.95UCL 
     10       6       3       1      NA </code></pre>
</div>
<p>where we have:</p>
<ul>
<li><strong>n</strong> - number of participants,</li>
<li><strong>events</strong> - number of deaths, which are generically called <strong>event</strong> since you can study other types of ‚Äú<strong>dead</strong>lines‚Äù üòÇ, like relapse of the sickness, or first break of the car,</li>
<li>the <strong>median</strong> survival time estimated instead of the mean due to a non-parametric (explained later) nature of survival analysis and</li>
<li><strong>95% confidence intervals</strong> for the median survival time</li>
</ul>
<p>Much more information can be assessed by the <code>summary</code> function, which, surprisingly üòâ, delivers the same table which we just calculated above manually:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># big summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>survival_model</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Call: survfit(formula = Surv(time, status) ~ 1, data = d)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     10       3     0.70   0.145       0.4665        1.000
    2      7       1     0.60   0.155       0.3617        0.995
    3      5       1     0.48   0.164       0.2458        0.938
    7      2       1     0.24   0.188       0.0515        1.000</code></pre>
</div>
<p>Now you can be sure, our calculations were correct and you have successfully learned how to do survival analysis. Congrats! So that from now on you can start using software. It has a lot of advantages! For instance, a <code>summary</code> function, which only displays the result of dead cases, can be filled with an additional argument <code>censored = TRUE</code>, which displays all, dead and censored cases:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>survival_model</span>, censored <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Call: survfit(formula = Surv(time, status) ~ 1, data = d)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     10       3     0.70   0.145       0.4665        1.000
    2      7       1     0.60   0.155       0.3617        0.995
    3      5       1     0.48   0.164       0.2458        0.938
    4      4       0     0.48   0.164       0.2458        0.938
    5      3       0     0.48   0.164       0.2458        0.938
    7      2       1     0.24   0.188       0.0515        1.000
   10      1       0     0.24   0.188       0.0515        1.000</code></pre>
</div>
<p>Great! Right? But what if you have thousands of days (your table would be huge!), but you are interested in only a few of them? Well, you can specify the results of which day you want to see by adding a <code>times = ...</code> argument to the <code>summary</code> function. A cool üòé thing about it is that you can even ask for the days, where no data were available for, e.g.¬†day 8 or 9 in our simple example. For instance, the probability of survival beyond day 8 is 24%:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>survival_model</span>, times <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Call: survfit(formula = Surv(time, status) ~ 1, data = d)

 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    8      1       6     0.24   0.188       0.0515            1
    9      1       0     0.24   0.188       0.0515            1</code></pre>
</div>
<p>Now, since we know the exact probability of survival on <strong>each day</strong>, even on days we did not have the data for, we can visualize the model results. Install and load a <code>survminer</code> package to be able to execute the code below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># install.packages("survminer")</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rpkgs.datanovia.com/survminer/index.html'>survminer</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/survminer/man/ggsurvplot.html'>ggsurvplot</a></span><span class='op'>(</span>
  <span class='va'>survival_model</span>, 
  conf.int <span class='op'>=</span> <span class='cn'>FALSE</span>, 
  surv.median.line <span class='op'>=</span> <span class='st'>"hv"</span>,
  xlab <span class='op'>=</span> <span class='st'>"Days"</span>, 
  ylab <span class='op'>=</span> <span class='st'>"Survival probability"</span>, 
  break.time.by <span class='op'>=</span> <span class='fl'>1</span>,
  risk.table <span class='op'>=</span> <span class='cn'>T</span>
<span class='op'>)</span>
</code></pre>
</div>
<p><img src="survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-17-1.png" width="624" /></p>
</div>
<p>Despite the fact that we could have easily calculated the probabilities for every day, you‚Äôll never do it by hand. It could be thousands of day. Thus, you‚Äôll let the software do the work and you‚Äôll get much more results then you can and want calculate yourself, e.g.¬†confidence intervals (CIs) for everyday survival or the survival plot. The CIs are visualized per default, but we can remove them if needed via the <code>conf.int = FALSE</code> command. The last row in the code above displays a ‚ÄúNumber at risk‚Äù table, which we also calculated manually above. So, why did we calculate something manually at all then, if we can get everything and more from the software? Well, it was important to go through the calculation process step-by-step in order to increase your intuition about the survival analysis curve!</p>
<p>Interestingly, this curve was independently described by two different scientists at the same time. Edward Kaplan and Paul Meier then published their findings together as the <strong>Kaplan-Meier (KM) estimator </strong> in 1958.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> And <code>survfit</code> function fits <code>type = "kaplan-meier"</code> curve by default.</p>
<p>Most of the survival data shows a lot of events in the beginning and lower number of events throughout the time. This makes the survival curve non-linear and most the survival data skewed or non-normally (not bell shaped) distributed. These are the reasons why KM method estimates <strong>median survival time</strong> instead of the mean as a measure of central tendency. The non-linearity and the ‚Äústepiness‚Äù of the KM curve make it <strong>impossible</strong> to summarize the data into one single <strong>parameter</strong>, e.g.¬†the <strong>slope</strong>, which makes the KM method <strong>non-parametric</strong>.</p>
<h3 id="interpretation-of-kaplan-meier-curve">Interpretation of Kaplan-Meier Curve</h3>
<p>The <strong>x-axis</strong> represents time in days, and the <strong>y-axis</strong> shows the probability of surviving or the proportion of people surviving. So, the <strong>curve itself</strong> shows the exact <strong>survival probability over time</strong>. A <strong>vertical drop</strong> in the curve indicates at least one <strong>event</strong>. The <strong>height of a vertical drop</strong> shows the change in cumulative survival probability. A <strong>horizontal part</strong> of the curve represents survival duration for the <strong>certain time interval</strong>, which is terminated by the next event (and drop of the curve). The KM curve looks like a strange <strong>staircase</strong> with uneven <strong>steps</strong>, where survival probability is constant between the events, and is therefore a <strong>step function</strong> that changes value only at the time of each event. In this way each patient contributes valuable information to the calculations for as long as it is alive. <strong>Censored</strong> people are shown exactly like in the survival object, with <strong>pluses</strong>, as you can see on the day 2. However, most of the pluses look like <strong>vertical ticks</strong>, since they lie on the horizontal part of the curve, i.e.¬†days 4 and 5. The tick marks are shown by default, but could be suppressed using the argument <code>censor = FALSE</code>. The <strong>risk table below the plot</strong> shows the <strong>number of people at risk</strong>, which are actually <strong>all ‚Äúreally alive‚Äù people in the experiment</strong> which did not experience the event or censoring at a particular time point. <strong>Dashed line</strong> represents the <strong>median survival time</strong> which corresponds to a <strong>survival probability of 50%</strong>. And if we ignore censoring and simply estimate the median of time (for only dead people), we‚Äôll get 1.5 instead of 3, which will increase the survival provability from 48% to 70%. Again, ignoring censoring will result into overestimation of survival probability due to a survivorship bias.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>d</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>status</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarize</span><span class='op'>(</span>median_survival_whithout_censoring <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 1
  median_survival_whithout_censoring
                               &lt;dbl&gt;
1                                1.5</code></pre>
</div>
<h2 id="comparing-survival-of-groups">Comparing survival of groups</h2>
<h3 id="groups">2 groups</h3>
<p>Now, let‚Äôs follow 100 people after Titanic crash instead of 10 and look at their survival using the Kaplan-Meier curve below. The numbers in the risk table are getting bigger and we‚Äôd better display the percentages at risk in brackets near the absolute values. The <code>risk.table = "abs_pct"</code> argument helps with that. The ‚Äúround‚Äù example of 100 people gives us exactly the same percentages as the absolute numbers, however with a less ‚Äúround‚Äù number or several groups the percentages would become very useful. The median survival time of people in the cold ocean is around 70 days and the confidence intervals aren‚Äôt very wide, so that we can be pretty confident in our numbers:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>999</span><span class='op'>)</span> <span class='co'># for reproducible example</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'>ggstatsplot</span><span class='fu'>::</span><span class='va'><a href='https://indrajeetpatil.github.io/ggstatsplot/reference/Titanic_full.html'>Titanic_full</a></span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>survived <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Survived</span> <span class='op'>==</span> <span class='st'>"No"</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,
         time     <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>2201</span>, min<span class='op'>=</span><span class='fl'>1</span>, max<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>sample_n</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span> 

<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/survfit.html'>survfit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>survived</span><span class='op'>)</span> <span class='op'>~</span> <span class='fl'>1</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/survminer/man/ggsurvplot.html'>ggsurvplot</a></span><span class='op'>(</span><span class='va'>m</span>, 
           conf.int <span class='op'>=</span> <span class='cn'>TRUE</span>, 
           risk.table <span class='op'>=</span> <span class='st'>"abs_pct"</span>, 
           surv.median.line <span class='op'>=</span> <span class='st'>"hv"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<p>But can we have two survival curves on the same plot and compare them somehow? Of coarse! In fact, that is the moment where the fun starts. For instance, we can compare survival probabilities of males vs.¬†females. For this we only need to replace <code>~1</code> in the model formula with the name of a categorical variable of interest, e.g.¬†<code>sex</code>. Survival plot then displays a Kaplan-Meier curve for every category of your variable:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/survfit.html'>survfit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>survived</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>Sex</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/survminer/man/ggsurvplot.html'>ggsurvplot</a></span><span class='op'>(</span><span class='va'>m</span>, 
           pval <span class='op'>=</span> <span class='cn'>TRUE</span>, 
           conf.int <span class='op'>=</span> <span class='cn'>TRUE</span>, 
           risk.table <span class='op'>=</span> <span class='st'>"abs_pct"</span>, 
           surv.median.line <span class='op'>=</span> <span class='st'>"hv"</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<h3 id="interpretation-of-groups-comparison-using-4-benchmarks">Interpretation of groups comparison using 4 benchmarks</h3>
<ol type="1">
<li><p>the <strong>visual comparison of curves</strong>: just by looking at two groups we can say whether there is a difference. For instance, our plot reveals that females have higher probability of survival almost thought the whole time period (x-axes). However, <strong>whether this difference is statistically significant requires a formal statistical test</strong>. We could go further and look at the numbers of the curve, for instance: at the sunny and beautiful day before the crush, the survival probability of both groups is 1.0 (or 100% of the passengers are alive). At day 50, the probability of survival of females is ca. 0.75 (or 75%) and only ca. 0.65 (or 65%) for males. At day 75, the survival is ca. 60 and ca. 30% accordingly.</p></li>
<li><p>comparison of <strong>confidence intervals (CIs)</strong>: overlapping CIs show that survival of males and females is not too different and could be due to chance all the way to ca. 80 days. After 80 days CIs stop overlapping which suggests significant difference in survival at a particular time point, say 90 days.</p></li>
<li><p>estimated <strong>median survival times</strong> reveals more then confidence intervals. The median survival time for each group represents the <strong>time at which the survival probability</strong> is 50%. For instance the median survival of Females is much higher (87 days) then males (65 days). Such a huge difference of 23 days sounds significant to me, because females have 23 more days to be found by some fishing boat. Here again, only test can tell and that is why the last benchmark for comparing two groups is the <strong>p-value</strong> estimated by a <strong>Log-Rank test</strong> (Peto et al, 1977), which is so important, that it deserves an extra chapter.</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m</span>
</code></pre>
</div>
<pre><code>Call: survfit(formula = Surv(time, survived) ~ Sex, data = d)

            n events median 0.95LCL 0.95UCL
Sex=Female 31     10   87.0    60.9      NA
Sex=Male   69     54   64.5    53.6    72.9</code></pre>
</div>
<h3 id="log-rank-test">Log-Rank test</h3>
<ol start="4" type="1">
<li>A <strong>non-parametric Log-Rank</strong> (sometimes called Mantel-Haenszel) statistical test compares median survival times of groups. Log-Rank test is similar to a (1) non-parametric <em>Wilcoxon-Rank</em> test, which also compares medians using ranks and it is also similar to a (2) Chi-square test, where we compare the observed number of events to the expected ones by calculating Chi-square statistic:</li>
</ol>
<p><span class="math display">\[ X^2 = \sum_{i = 1}^{g} \frac{(O_i - E_i)^2}{E_i}\]</span></p>
<p>The expected numbers of events are calculated for <strong>each time point and each group</strong> as compared to the previous time point. These values are then summed over all time points to give the total expected number of events in each group.</p>
<p>The non-parametric nature of the test makes <strong>no assumptions about the survival distributions</strong>. So, is survival time normal (‚Äúbell curvy‚Äù)? It can be, but does not have to! In fact, survival data are <strong>very rarely normally distributed</strong>, but are often skewed due to a <strong>typically many early events and relatively few late ones</strong>.</p>
<p>The <strong>null hypothesis</strong> of the Log-Rank test is that there is <strong>no difference in survival between the two groups</strong>. The p-value of 0.011 allows us to <strong>reject the null hypothesis and indicates a significant median difference in survival time between females and males.</strong></p>
<p>The Log-Rank test is soo widely used for comparing two or more survival curves, that you actually have to heavily justify the usage of any other test.</p>
<p>The function <code>survdiff()</code> computes Log-Rank test and returns following components:</p>
<ul>
<li>the <strong>number</strong> of subjects in each group.</li>
<li>the weighted <strong>observed</strong> number of events in each group.</li>
<li>the weighted <strong>expected</strong> number of events in each group.</li>
<li>the <strong>Chi-square statistic</strong> for a test of equality</li>
<li>and the <strong>p-value</strong> for the difference in survival among the groups</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/survival/man/survdiff.html'>survdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>survived</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>Sex</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Call:
survdiff(formula = Surv(time, survived) ~ Sex, data = d)

            N Observed Expected (O-E)^2/E (O-E)^2/V
Sex=Female 31       10     19.3      4.45      6.46
Sex=Male   69       54     44.7      1.92      6.46

 Chisq= 6.5  on 1 degrees of freedom, p= 0.01 </code></pre>
</div>
<p>Is the Log-Rank test perfect? Unfortunately, no. One problem is: it <strong>does not provide an effect size</strong> which leaves us with only p-value as a measure of difference. Another problem with Log-Rank test (and Kaplan-Meier method in general) is that it <strong>does not allow confounders</strong>, it ignores other factors/variables. Fortunately, we still can compare more then two groups of a single variable üòâ.</p>
<h3 id="groups-and-multiple-pairwise-post-hoc-log-rank-test">&gt; 2 groups and multiple pairwise (post-hoc) Log-Rank test</h3>
<p>Log-Rank test can compare more then two groups and say whether there is a significant (p-value &lt; 0.05) difference among these groups. The test results displayed in the table and KM curve below show that there is a significant difference in survival (p-value = 0.024) among groups of people in different ticket classes. However, like the most other tests (e.g.¬†ANOVA) it does not say between which groups exactly. That is why we need an additional analysis which pairwisely compares each group to each other group. Such analysis is often called a <strong>post-hoc</strong>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/survival/man/survdiff.html'>survdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>survived</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>Class</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Call:
survdiff(formula = Surv(time, survived) ~ Class, data = d)

            N Observed Expected (O-E)^2/E (O-E)^2/V
Class=1st  14        4    11.03     4.477     5.532
Class=2nd  13        5     8.49     1.432     1.666
Class=3rd  37       30    21.81     3.074     4.760
Class=Crew 36       25    22.68     0.238     0.383

 Chisq= 9.5  on 3 degrees of freedom, p= 0.02 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/survfit.html'>survfit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>survived</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>Class</span>, data <span class='op'>=</span> <span class='va'>d</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/survminer/man/ggsurvplot.html'>ggsurvplot</a></span><span class='op'>(</span><span class='va'>m</span>, 
           pval <span class='op'>=</span> <span class='cn'>TRUE</span>, 
           conf.int <span class='op'>=</span> <span class='cn'>FALSE</span>, 
           risk.table <span class='op'>=</span> <span class='st'>"abs_pct"</span>, 
           surv.median.line <span class='op'>=</span> <span class='st'>"hv"</span>,
           ncensor.plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
           break.time.by <span class='op'>=</span> <span class='fl'>20</span>,
           risk.table.y.text.col <span class='op'>=</span> <span class='cn'>TRUE</span>, risk.table.y.text <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-23-1.png" width="864" /></p>
</div>
<p>Three further useful plot arguments which can help to better visualize survival data are:</p>
<ul>
<li><code>break.time.by = 20</code> break the x-axis into wishful time intervals.</li>
<li><code>risk.table.y.text.col = TRUE</code> and <code>risk.table.y.text = FALSE</code> plots bars instead of names in text annotations of the legend of risk table</li>
<li><code>ncensor.plot = TRUE</code> displays the number of censored subjects, which helps to understand what is the cause that the risk number becomes smaller: the event or censoring.</li>
</ul>
<p><strong>Interpretation</strong></p>
<p>The <strong>median survival</strong> is ca. 90 days for the passengers in the 1st and 2nd classes, 58 days for the 3rd class and 65 days for the crew of the Titanic, suggesting a good survival of rich people, as compared to the rest. A <strong>low p-value (p = 0.024) suggests that there is a significant difference in survival among groups</strong>. Among which, only post-hoc can tell. The results of such <strong>post-hoc Log-Rank analysis</strong> can be conducted with <code>pairwise_survdiff</code> function form the <code>survminer</code> package and are displayed below. As usual, if we have <strong>multiple comparisons</strong>, we run into a risk of making a false discovery or missing an important discovery. Thus, we have to <strong>adjust the p-values</strong> in order to reduce the probability of making an error. I personally prefer the <strong>Benjamini &amp; Hochberg (1995) adjustment</strong> method to the famous but conservative <strong>Bonferroni</strong> method:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/survminer/man/pairwise_survdiff.html'>pairwise_survdiff</a></span><span class='op'>(</span>
  formula <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>survived</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>Class</span>, data <span class='op'>=</span> <span class='va'>d</span>, p.adjust.method <span class='op'>=</span> <span class='st'>"fdr"</span>
  <span class='op'>)</span>
</code></pre>
</div>
<pre><code>
    Pairwise comparisons using Log-Rank test 

data:  d and Class 

     1st   2nd   3rd  
2nd  0.414 -     -    
3rd  0.028 0.139 -    
Crew 0.095 0.317 0.414

P value adjustment method: fdr </code></pre>
</div>
<p>The results of the post-hoc analysis revealed that the survival of the 1st class is significantly higher as compared to the 3rd class and the Crew. And despite the fact that the median survival of the 2nd class passengers is very similar to the first, the confidence intervals of this survival are wide and do overlap with other groups a lot (not shown to avoid clutterness). That is why the 2nd class passengers do not <em>generally</em> have significantly higher survival time despite much higher <em>median</em> survival time.</p>
<h3 id="multiple-survival-curves">Multiple survival curves</h3>
<p>As mentioned above, the Log-Rank test can not be applied to several variables. However, we still can plot survival curves of several variables in order to get some intuition for our data. Further methods, e.g.¬†Cox models, are able to estimate difference among several variables, but they are more complex than the KM-method and thus will be covered in future posts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/survfit.html'>survfit</a></span><span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>survived</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>Sex</span> <span class='op'>+</span> <span class='va'>Class</span>, data <span class='op'>=</span> <span class='va'>d</span> <span class='op'>)</span>

<span class='va'>ggsurv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survminer/man/ggsurvplot.html'>ggsurvplot</a></span><span class='op'>(</span><span class='va'>m2</span>, conf.int <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
   
<span class='va'>ggsurv</span><span class='op'>$</span><span class='va'>plot</span> <span class='op'>+</span><span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>theme</span> <span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"right"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>facet_grid</span><span class='op'>(</span><span class='va'>Sex</span> <span class='op'>~</span> <span class='va'>.</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves_files/figure-html5/unnamed-chunk-25-1.png" width="624" /></p>
</div>
<p>The intuition we can get from the plots above is that rich women (1st and 2nd ticket classes) and (only 2) women from the crew have 100% probability of survival, while pure women in the 3rd class will die with a similar certainty as men. Heavily overlapping CIs of men survival suggests that all man will eventually die after the Titanic accident.</p>
<h2 id="conclusions">Conclusions</h2>
<p>Survival analysis investigates the <strong>time it takes for an event of interest</strong> to occur. Most of the univariate (single variable) survival analyses uses <strong>Kaplan-Meier plots</strong> to visualize the survival curves and <strong>Log-Rank test</strong> to compare the survival curves of two or more groups.</p>
<ul>
<li><strong>Advantages</strong>:</li>
</ul>
<ol type="1">
<li><p>The crucial <strong>advantage</strong> of survival probability curve vs.¬†logistic regression curve is accounting for censored data, which are neither dead, nor alive. Logistic regression treats all the people who didn‚Äôt die as survived, which is wrong, simply because we don‚Äôt know the survival status of a missed person. Patients leave the study due to two main reasons, they either fill so bad, that they don‚Äôt care about your experiment anymore, or they feel much better and forget your study. Some patients may simply move to the other city without saying anything. Counting all of them as survived, as logistic regression does, would overestimate the survival probability (survivorship bias) and underestimate the hazard of death. The survival analysis is therefore more precise as compared to a logistic regression, while it still catches a non-linear trend in probabilities.</p></li>
<li><p>Another <strong>advantage</strong> is the non-parametric nature of the Kaplan-Meier method, which does not have too many assumptions. In fact the only important <strong>assumption</strong> is that <strong>censoring should be non-informative</strong>. Why? More information is always better, right? Yes! But if we know why people leave the study, we could use this information as a new variable and study it‚Äôs influence on survival. The KM method would then be inappropriate, because it will miss this information. However, often we don‚Äôt know (no-info) why people leave (are censored). And in this case the KM-method squeezes the most inference out of such non-informative data.</p></li>
</ol>
<ul>
<li><strong>Disadvantages</strong>:</li>
</ul>
<ol type="1">
<li><p>The Kaplan-Meier ‚Äúcurve‚Äù does not actually look like a curve. Oppositely to the logistic regression Kaplan-Meier method <strong>can not be described as a smooth function (curve) by a few parameters, e.g.¬†the slope or odds-ratio</strong>. That is why we need the fool table of results or a graph.</p></li>
<li><p>Kaplan-Meier method <strong>can‚Äôt model numeric variables</strong>, but only categorical.</p></li>
<li><p>Kaplan-Meier method <strong>can‚Äôt include many explanatory variables</strong>. It‚Äôs bad, because comparing groups in terms of survival may miss the effect of <strong>other factors, known as covariates or confounders, which could potentially affect the survival time of a particular group</strong>.</p></li>
</ol>
<ul>
<li><strong>Recommendations</strong>:</li>
</ul>
<ol type="1">
<li><p>always <strong>display statistical uncertainty</strong> by including 95% CIs or/and a p-value of the Log-Rank test. Displaying CIs at a few important time points on the plot for each treatment group may sometimes be clearer then displaying them for all time points. Non-overlapping CIs indicate significant difference between groups.</p></li>
<li><p><strong>consider cutting the x-axis</strong>. Why? Well, the eye is naturally drawn to the right part of the plot, where the time ends. However, the end of the plot contains the least amount of information and greatest uncertainty due to just a low number of remaining participants. How far in time to extend the plot? It‚Äôs up to you.</p></li>
<li><p>always <strong>display the risk table</strong> showing the numbers of patients event-free and still in follow-up in each treatment group at relevant time points.</p></li>
</ol>
<h2 id="whats-next">What‚Äôs next?</h2>
<p>Several methods can address the disadvantages of the Kaplan-Meier method. Particularly, <a href="https://yury-zablotski.netlify.com/post/survival-2/"><strong>exponential parametric models</strong></a> provide a smooth function which is able to describe the <em>survival curve</em> as an actual <em>curve</em> in a few parameters, like slope (that‚Äôs why - parametric). And <strong>Cox-Proportional-Hazard model</strong> can be extended to several variables (in progress).</p>
<p>If you think, I missed something, please comment on it, and I‚Äôll improve this tutorial.</p>
<p><strong>Thank you for learning!</strong></p>
<h2 id="further-readings-videos-and-references">Further readings, videos and references</h2>
<ul>
<li><p>Clark, T., Bradburn, M., Love, S., &amp; Altman, D. (2003). Survival analysis part I: Basic concepts and first analyses. 232-238. ISSN 0007-0920.</p></li>
<li><p>the whole playlist of videos from MarinStatsLectures! They are amazing! <a href="https://www.youtube.com/watch?v=vX3l36ptrTU&amp;list=PLqzoL9-eJTNDdnKvep_YHIwk2AMqHhuJ0" class="uri">https://www.youtube.com/watch?v=vX3l36ptrTU&amp;list=PLqzoL9-eJTNDdnKvep_YHIwk2AMqHhuJ0</a></p></li>
<li><p><code>survminer</code> cheat sheet: <a href="https://rpkgs.datanovia.com/survminer/survminer_cheatsheet.pdf" class="uri">https://rpkgs.datanovia.com/survminer/survminer_cheatsheet.pdf</a></p></li>
<li><p><a href="https://www.emilyzabor.com/tutorials/survival_analysis_in_r_tutorial.html#part_1:_introduction_to_survival_analysis" class="uri">https://www.emilyzabor.com/tutorials/survival_analysis_in_r_tutorial.html#part_1:_introduction_to_survival_analysis</a></p></li>
<li><p>One of the best places to learn R is R-Bloggers platform: <a href="http://www.R-bloggers.com" class="uri">http://www.R-bloggers.com</a></p></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Kaplan, E.L. and Meier, P. (1958) Nonparametric Estimation from Incomplete Observations. Journal of the American Statistical Association, 53, 457-481. <a href="http://dx.doi.org/10.1080/01621459.1958.10501452" class="uri">http://dx.doi.org/10.1080/01621459.1958.10501452</a><a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Survival%20analysis%201%3A%20a%20gentle%20introduction%20into%20Kaplan-Meier%20Curves&amp;url=https%3A%2F%2Fyuryzablotski%2FyuzaR-Blog.github.io%2Fposts%2F2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fyuryzablotski%2FyuzaR-Blog.github.io%2Fposts%2F2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves%2F&amp;title=Survival%20analysis%201%3A%20a%20gentle%20introduction%20into%20Kaplan-Meier%20Curves" aria-label="share on linkedin">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fyuryzablotski%2FyuzaR-Blog.github.io%2Fposts%2F2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves%2F" aria-label="share on facebook">
        <i class="fab fa-facebook" aria-hidden="true"></i>
      </a>
      <a href="https://plus.google.com/share?url=https%3A%2F%2Fyuryzablotski%2FyuzaR-Blog.github.io%2Fposts%2F2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves%2F" aria-label="share on google-plus">
        <i class="fab fa-google-plus" aria-hidden="true"></i>
      </a>
      <a href="https://pinterest.com/pin/create/link/?url=https%3A%2F%2Fyuryzablotski%2FyuzaR-Blog.github.io%2Fposts%2F2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves%2F&amp;description=Survival%20analysis%201%3A%20a%20gentle%20introduction%20into%20Kaplan-Meier%20Curves" aria-label="share on pinterest">
        <i class="fab fa-pinterest" aria-hidden="true"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://yuzar-blog.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script type="text/javascript" cookie-consent="functionality">
var disqus_config = function () {
  this.page.url = 'https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/';
  this.page.identifier = 'posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://yuzar-blog.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/yuryzablotski/yuzaR-Blog/issues/new">create an issue</a> on the source repository.</p>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. Source code is available at <a href="https://github.com/yuryzablotski/yuzaR-Blog">https://github.com/yuryzablotski/yuzaR-Blog</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Zablotski (2021, Jan. 3). yuzaR-Blog: Survival analysis 1: a gentle introduction into Kaplan-Meier Curves. Retrieved from https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{zablotski2021survival,
  author = {Zablotski, Yury},
  title = {yuzaR-Blog: Survival analysis 1: a gentle introduction into Kaplan-Meier Curves},
  url = {https://yuryzablotski/yuzaR-Blog.github.io/posts/2021-01-03-survival-analysis-1-a-gentle-introduction-into-kaplan-meier-curves/},
  year = {2021}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
